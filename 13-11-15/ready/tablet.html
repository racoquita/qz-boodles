<style type="text/css">
	*{margin:0;padding:0}#qzad{position:relative;top:0;left:0;width:480px;height:550px;background:url(http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/bg.jpg) 0 0 no-repeat}img{display:block;margin:0 auto;width:100%}#tcontainer,#bcontainer{position:absolute;top:0;left:0;width:480px;height:550px;visibility:hidden;overflow:hidden}
	#tcontainer{z-index:2}#bcontainer{z-index:1;opacity:0}#bcontainer.fadeIn{-webkit-transition:opacity 2s ease;-moz-transition:opacity 2s ease;-ms-transition:opacity 2s ease;-o-transition:opacity 2s ease;transition:opacity 2s ease;opacity:1}.bpanel{opacity:0}
	.tpanel,.bpanel{height:100%;float:left;position:relative}.tpanel{opacity:1}.top{z-index:3}.bottom{z-index:1}.top,.bottom{position:absolute;width:100%;height:100%;background-repeat:no-repeat}.move{-webkit-transition:all 3s ease-in;-moz-transition:all 3s ease-in;-ms-transition:all 3s ease-in;-o-transition:all 3s ease-in;transition:all 3s ease-in}
	.moveIn{opacity:1;-webkit-transition:all 1s ease-in;-moz-transition:all 1s ease-in;-ms-transition:all 1s ease-in;-o-transition:all 1s ease-in;transition:all 1s ease-in}.fade{-webkit-transition:opacity .5s ease;-moz-transition:opacity .5s ease;-ms-transition:opacity .5s ease;-o-transition:opacity .5s ease;transition:opacity .5s ease;opacity:0}
	.fadeIn{-webkit-transition:opacity 2s ease;-moz-transition:opacity 2s ease;-ms-transition:opacity 2s ease;-o-transition:opacity 2s ease;transition:opacity 2s ease;opacity:1}.panel{height:100%;float:left;overflow:hidden;position:relative}.inner,.other{position:absolute;width:100%;height:100%;background-repeat:no-repeat;-webkit-transition:all .6s ease;-moz-transition:all 1s ease;-ms-transition:all 1s ease;-o-transition:all 1s ease;transition:all 1s ease}
	#logo{position:absolute;top:443px;left:103px;z-index:4}.cta,.copy{position:absolute;top:497px;left:143px;width:211px;height:44px;display:none;z-index:4}.cta a,.copy a{display:block;width:100%;height:44px}.copy{display:block}.cta2{position:absolute;top:21px;left:16px;width:125px;height:44px;z-index:4}
	.cta2 a{display:block;width:100%;height:44px}
</style>
<meta name="viewport" content="initial-scale=1">
<div id="qzad">
	<div id="tcontainer" class="bg-container"></div>
	<div id="bcontainer" class="bg-container"></div>
	<div id="logo">
		<img src="http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/logo.png" alt="">
	</div>
	<div class="copy">
		<img src="http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/a-copy.png" alt="">
	</div>
	<div class="cta2">
		<a href="http://www.boodles.com/" class="ixtrack" data-ix-category="external" data-ix-label="shop collection">
			<img src="http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/cta2.png" alt="">
		</a>
	</div>
	<div class="cta">
		<a href="http://www.boodles.com/" class="ixtrack" data-ix-category="external" data-ix-label="boodles website - shop online">
			<img src="http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/b-copy.png" alt="">
		</a>
	</div>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script id="ix-namer"
	data-ix-name="Boodles Tablet"
	src="http://ads.qz.com/js/qzad/qzad-1.0.js"
	type="text/javascript"></script>
<script src="http://app.qz.com/js/frameMessager/QZIX.js" type="text/javascript"></script>
<script src="http://app.qz.com/js/frameMessager/frameMessager.js" type="text/javascript"></script>
<script type="text/javascript">
	var qz = {};

	qz.transx = function(elemt, elemb, arr, num) {
		var elt;
		var elb;
		var panelSize;
		var panelLeft;
		var panelRight;
		var cssTime = 5000;
		var waitForFinalEvent = (function() {
			var timers = {};
			return function (callback, ms, uniqueId) {
				if (!uniqueId) uniqueId = "uniqueId";
				if (timers[uniqueId]) clearTimeout (timers[uniqueId]);
				timers[uniqueId] = setTimeout(callback, ms);
			};
		})();

		(function(){init()})();

		function init() {
			if(elemt && elemb && arr && num) {
				if(elt = document.getElementById(elemt)) {
					elb = document.getElementById(elemb);
					setSizing();
					window.addEventListener('load', function(){
					  	elt.setAttribute('style','visibility:visible;');
					  	elb.setAttribute('style','visibility:visible;');
					});
					window.addEventListener('resize', function(e){
						waitForFinalEvent(function(){
							next = 0;
							elt.innerHTML = "";
							elb.innerHTML = "";
							setSizing();
						}, 250, 'unique');
					});
				} else { throw new Error('an element with the id of "' + elemt + '" was not found'); }
			} else { throw new Error('required parameter(s) missing'); }
		};
		function setSizing() {
			var w = elt.clientWidth;
			var s = w % num;

			if(!s) {
				panelSize = panelLeft = panelRight = w / num;
			} else {
				panelSize = Math.floor(w / num);
				if(!(s % 2)) {
					panelLeft = panelRight = (panelSize + s / 2);
				} else {
					panelLeft = panelSize + Math.ceil(s / 2);
					panelRight = panelSize + Math.floor(s / 2);
				}
			}
			createPanelsOut();
			createPanelsIn();
		};
		function createPanelsOut() {
			var panel;
			var top;
			var multiplier = (elt.clientWidth / 480);
			var move = (Math.abs(multiplier - 1) * 150);

			for(var i = 0; i < num; i++){
				panel = document.createElement('div');
				panel.className = 'tpanel';
				top = document.createElement('div');
				top.className = 'top';
				top.style.backgroundImage = "url('"+ arr[1] +"')";
				if(i == 0) {
					panel.setAttribute('style','width:' + panelLeft + 'px');
					top.style.backgroundPosition = "-" + move + "px 0px";
				} else if(i == (num - 1)) {
					panel.setAttribute('style','width:' + panelRight + 'px');
					top.style.backgroundPosition = "-" + (move + panelLeft + (panelSize * (num - 2))) + "px 0px";
				} else {
					panel.setAttribute('style','width:' + panelSize + 'px');
					top.style.backgroundPosition = "-" + (move + (panelSize * i) + (panelLeft - panelSize)) + "px 0px";
				}
				panel.appendChild(top);
				elt.appendChild(panel);
			}
		};
		function createPanelsIn() {
			var panel;
			var bottom;
			var multiplier = (elt.clientWidth / 480);
			var move = (Math.abs(multiplier - 1) * 150);
			
			for(var i = 0; i < num; i++){
				panel = document.createElement('div');
				panel.className = 'bpanel';
				bottom = document.createElement('div');
				bottom.className = 'bottom';
				bottom.style.backgroundImage = "url('"+ arr[0] +"')";
				if(i == 0) {
					panel.setAttribute('style','width:' + panelLeft + 'px');
					bottom.style.backgroundPosition = "-" + move + "px 0px";
				} else if(i == (num - 1)) {
					panel.setAttribute('style','width:' + panelRight + 'px');
					bottom.style.backgroundPosition = "-" + (move + panelLeft + (panelSize * (num - 2))) + "px 0px";
				} else {
					panel.setAttribute('style','width:' + panelSize + 'px');
					bottom.style.backgroundPosition = "-" + (move + (panelSize * i) + (panelLeft - panelSize)) + "px 0px";
				}
				panel.appendChild(bottom);
				elb.appendChild(panel);
			}
		};
		function doOut(i, a) {
			var p = document.getElementsByClassName('tpanel');
			var t = factorial() / num;

			setTimeout(function(){
				setTimeout(function(){
					a.className = a.className += " move";
					a.style.backgroundPosition = (i * 250 + elt.clientWidth) + 'px 0px';
				}, (num - i) * 100);

				setTimeout(function(){
					p[i].className = p[i].className + ' fade';
				}, ((num - i) * (t/2)) + 500);
			}, i);
		};
		function doIn(i, a) {
			var p = document.getElementsByClassName('bpanel');
			var t = factorial() / num;
			var move = 0;

			setTimeout(function(){
				a.className = a.className += " moveIn";
				if(i == 0) {
					a.style.backgroundPosition = '-' + move + 'px 0px';
				} else if(i == (num - 1)) {
					a.style.backgroundPosition = "-" + (move + elb.clientWidth - panelLeft) + 'px 0px';
				} else {
					a.style.backgroundPosition = "-" + (move + panelSize * i) + 'px 0px';
				}
				p[i].className = p[i].className + ' fadeIn';
			}, (num - i) * 100);
		};
		function factorial() { 
			var result = 0;
			for(var i = 0;i < num;i++) { result += i * 100 }
			return result;
		} 
		qz.transx.out = function() {
			var a = document.getElementsByClassName('top');
			for(var i = a.length - 1;i >= 0;i--) {
				doOut(i, a[i]);
			}
			qz.transx.in();
		};
		qz.transx.in = function() {
			var a = document.getElementsByClassName('bottom');
			for(var i = 0;i < a.length;i++) {
				doIn(i, a[i]);
			}
		};
		qz.transx.reset = function() {
			next = 0;
			elt.innerHTML = "";
			elb.innerHTML = "";
			setSizing();
		};
	}
</script>

<script type="text/javascript">
	var cta, copy, imgB;
	$(document).ready(function(){
		qz.transx('tcontainer', 'bcontainer', [
			'http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/imgB.jpg',
			'http://ads.qz.com/sponsors/boodles/13-11-15/tablet/img/imgA.jpg'
		], 10);

		QZAD.init({
			el: document.getElementById( 'qzad' ),
	        frameHeight: 550,
	        App: { on: function() {startAd()}, off: function() {resetAd()}}
		});
	});

	function startAd() {
		cta = $('.cta');
		copy = $('.copy');
		imgB = $('#bcontainer');
		
		setTimeout(function() {
			qz.transx.out();
			copy.fadeOut(1500);
		}, 1500);
		setTimeout(function() {
			imgB.addClass('fadeIn');
			cta.fadeIn(1000);
		}, 3000);

	};

	function resetAd() {
		cta.attr('style','');
		copy.attr('style','');
		imgB.removeClass('fadeIn');
		qz.transx.reset();
	};
</script>
